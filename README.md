# Jmaka

–í–µ—Ä—Å–∏—è: 0.4.0

<pre>
<span style="color:#1d4ed8">     ‚ñà‚ñà‚ïó</span><span style="color:#0ea5e9">‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ñà‚ïó</span><span style="color:#1d4ed8"> ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó </span><span style="color:#0ea5e9">‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó</span><span style="color:#1d4ed8"> ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó </span>
<span style="color:#1d4ed8">     ‚ñà‚ñà‚ïë</span><span style="color:#0ea5e9">‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ïë</span><span style="color:#1d4ed8">‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó</span><span style="color:#0ea5e9">‚ñà‚ñà‚ïë ‚ñà‚ñà‚ïî‚ïù</span><span style="color:#1d4ed8">‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó</span>
<span style="color:#1d4ed8">     ‚ñà‚ñà‚ïë</span><span style="color:#0ea5e9">‚ñà‚ñà‚ïî‚ñà‚ñà‚ñà‚ñà‚ïî‚ñà‚ñà‚ïë</span><span style="color:#1d4ed8">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë</span><span style="color:#0ea5e9">‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù </span><span style="color:#1d4ed8">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë</span>
<span style="color:#1d4ed8">‚ñà‚ñà   ‚ñà‚ñà‚ïë</span><span style="color:#0ea5e9">‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë</span><span style="color:#1d4ed8">‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë</span><span style="color:#0ea5e9">‚ñà‚ñà‚ïî‚ïê‚ñà‚ñà‚ïó </span><span style="color:#1d4ed8">‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë</span>
<span style="color:#1d4ed8">‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù</span><span style="color:#0ea5e9">‚ñà‚ñà‚ïë ‚ïö‚ïê‚ïù ‚ñà‚ñà‚ïë</span><span style="color:#1d4ed8">‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë</span><span style="color:#0ea5e9">‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïó</span><span style="color:#1d4ed8">‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë</span>
<span style="color:#1d4ed8"> ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïù </span><span style="color:#0ea5e9">‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïù</span><span style="color:#1d4ed8">‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù</span><span style="color:#0ea5e9">‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù</span><span style="color:#1d4ed8">‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù</span>
</pre>


–ù–µ–±–æ–ª—å—à–æ–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ ASP.NET Core (Minimal API) –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π/–≤–∏–¥–µ–æ —á–µ—Ä–µ–∑ –ø—Ä–æ—Å—Ç–æ–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

## üöÄ –ß—Ç–æ —É–º–µ–µ—Ç Jmaka
- –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–¥–æ 15 –∑–∞ —Ä–∞–∑), –ª–∏–º–∏—Ç 75 MB –Ω–∞ —Ñ–∞–π–ª, —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ –∏–º–µ–Ω–∞ ‚Äî UUID.
- **–í—Å–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–æ—Ä–º–∞–ª–∏–∑—É—é—Ç—Å—è –≤ JPEG + sRGB —Å embedded ICC –ø—Ä–æ—Ñ–∏–ª–µ–º.**
- –î–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –º–∏–Ω–∏–∞—Ç—é—Ä—ã –ø—Ä–µ–≤—å—é (`/preview/*`).
- –û–±—â–∞—è –∏—Å—Ç–æ—Ä–∏—è –∑–∞–≥—Ä—É–∑–æ–∫ (`/history`) —Å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π ¬´–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É¬ª.
- –†–µ—Å–∞–π–∑ –ø–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —à–∏—Ä–∏–Ω–∞–º **1280 / 1920 / 2440** –ø–æ –∑–∞–ø—Ä–æ—Å—É (`/resize`), –∞–ø—Å–∫–µ–π–ª —Ä–∞–∑—Ä–µ—à—ë–Ω.
- –ö–∞–¥—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ (Crop) —Å –≤—ã–±–æ—Ä–æ–º –ø—Ä–æ–ø–æ—Ä—Ü–∏–π (1:1, 2:3, 16:9) –æ—Ç –Ω–µ–∏–∑–º–µ–Ω—ë–Ω–Ω–æ–≥–æ –∏—Å—Ö–æ–¥–Ω–∏–∫–∞ (`upload-original/*`).
- Split: —Å–∫–ª–µ–π–∫–∞ –¥–≤—É—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –æ–¥–Ω–æ 1280√ó720 —Å –±–µ–ª–æ–π –ø–æ–ª–æ—Å–æ–π 7px –ø–æ —Ü–µ–Ω—Ç—Ä—É (`/split`).
- Split3: —Å–∫–ª–µ–π–∫–∞ —Ç—Ä—ë—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –æ–¥–Ω–æ 1280√ó720 —Å –¥–≤—É–º—è –±–µ–ª—ã–º–∏ –ø–æ–ª–æ—Å–∞–º–∏ 7px (`/split3`).
- OknoFix: –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏ –ø–æ PNG-—à–∞–±–ª–æ–Ω—É (–ø–æ—Ä—Ç—Ä–µ—Ç–Ω–∞—è ¬´–∫–∞—Ä—Ç–æ—á–∫–∞¬ª —Å —Ä–∞–º–∫–æ–π/—Ç–µ–Ω—è–º–∏).
- OknoScale: —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º —Ç–æ–π –∂–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —Å –∏–∑–º–µ–Ω—è–µ–º–æ–π —à–∏—Ä–∏–Ω–æ–π –æ–∫–Ω–∞.
- Image Edit: —Å–µ—Ä–≤–µ—Ä–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ Brightness/Contrast/Saturation/Hue/Exposure/Vibrance (—Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∫ –Ω–æ–≤—ã–π —Ñ–∞–π–ª).
- Video Edit: –∑–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ —Å –ø–æ–ª–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
  - **Trim** ‚Äî —Ç—Ä–∏–º–º–∏–Ω–≥ –∏ –≤—ã—Ä–µ–∑–∞–Ω–∏–µ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –∏–∑ —Å–µ—Ä–µ–¥–∏–Ω—ã –≤–∏–¥–µ–æ
  - **Crop** ‚Äî –∫–∞–¥—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã 0-1)
  - **Rotate** ‚Äî –ø–æ–≤–æ—Ä–æ—Ç –Ω–∞ 90¬∞/180¬∞/270¬∞
  - **Flip** ‚Äî –æ—Ç—Ä–∞–∂–µ–Ω–∏–µ –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏ –∏ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏
  - **Speed** ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è (0.25x - 2.0x)
  - **Mute Audio** ‚Äî –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –∑–≤—É–∫–æ–≤–æ–π –¥–æ—Ä–æ–∂–∫–∏
  - **Reset** ‚Äî —Å–±—Ä–æ—Å –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
  - 2-pass —Å–∂–∞—Ç–∏–µ –≤ —Ü–µ–ª–µ–≤–æ–π —Ä–∞–∑–º–µ—Ä, –≤—ã—Ö–æ–¥ 16:9 H.264 —Å AAC –∞—É–¥–∏–æ (–∏–ª–∏ –±–µ–∑ –∑–≤—É–∫–∞)
- –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏ –∏ –≤—Å–µ—Ö —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (`/delete`).
- –ê–≤—Ç–æ-–æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Ñ–∞–π–ª–æ–≤ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è (retention, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 48 —á–∞—Å–æ–≤).

## üß≠ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–∫—Ä–∞—Ç–∫–æ)

### –ó–∞–≥—Ä—É–∑–∫–∞
- –ö–Ω–æ–ø–∫–∞-–¥–∏—Å–∫–µ—Ç–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–æ–≤ (–¥–æ 15 —à—Ç—É–∫).
- –ú–æ–∂–Ω–æ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç—å —Ñ–∞–π–ª—ã –º—ã—à—å—é –Ω–∞ –æ–∫–Ω–æ (drag & drop).
- –ú–æ–∂–Ω–æ –≤—Å—Ç–∞–≤–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑ –±—É—Ñ–µ—Ä–∞ –æ–±–º–µ–Ω–∞ (Ctrl+V).

### –¢–∞–±–ª–∏—Ü–∞ —Ñ–∞–π–ª–æ–≤
- –í –ª–µ–≤–æ–π —Ç–∞–±–ª–∏—Ü–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤—Å–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
- –í –∫–æ–ª–æ–Ω–∫–µ ¬´–û—Ä–∏–≥–∏–Ω–∞–ª¬ª ‚Äî –º–∏–Ω–∏–∞—Ç—é—Ä–∞ –ø—Ä–µ–≤—å—é –∏ –º–∞–ª–µ–Ω—å–∫–∞—è –∫–Ω–æ–ø–∫–∞-–¥–∏—Å–∫–µ—Ç–∞ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è.
- –ö–Ω–æ–ø–∫–∏ —Ä–∞–∑–º–µ—Ä–æ–≤ 1280 / 1920 / 2440 —Å–æ–∑–¥–∞—é—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–ø–∏–∏ –ø–æ –∑–∞–ø—Ä–æ—Å—É.
- –ö—Ä–µ—Å—Ç–∏–∫ —Å–ø—Ä–∞–≤–∞ —É–¥–∞–ª—è–µ—Ç –∑–∞–ø–∏—Å—å –∏ –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã.

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
- **Crop** ‚Äî –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –∫–∞–¥—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –≤—ã–±–æ—Ä–æ–º –ø—Ä–æ–ø–æ—Ä—Ü–∏–π; —Ä–µ–∂–µ—Ç—Å—è –≤—Å–µ–≥–¥–∞ –æ—Ç –∏—Å—Ö–æ–¥–Ω–∏–∫–∞ –≤ `upload-original`.
- **Split** ‚Äî –¥–≤–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è ‚Üí –æ–¥–∏–Ω –∫–∞–¥—Ä 1280√ó720 —Å –±–µ–ª–æ–π –ø–æ–ª–æ—Å–æ–π –ø–æ—Å–µ—Ä–µ–¥–∏–Ω–µ.
- **Split3** ‚Äî —Ç—Ä–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è ‚Üí –æ–¥–∏–Ω –∫–∞–¥—Ä 1280√ó720 —Å –¥–≤—É–º—è –±–µ–ª—ã–º–∏ –ø–æ–ª–æ—Å–∞–º–∏.
- **OknoFix** ‚Äî —Å—Ç—Ä–æ–≥–∏–π —Ä–µ–∂–∏–º –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏:
  - –æ–∫–Ω–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ –ø–æ –≤—ã—Å–æ—Ç–µ –∏ –ø–æ–ª–æ–∂–µ–Ω–∏—é –∫–∞–∫ –≤–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–º PNG-—à–∞–±–ª–æ–Ω–µ;
  - –∫–∞—Ä—Ç–∏–Ω–∫–∞ –ø–æ–¥–ª–æ–∂–∫–∏ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –∏ –¥–≤–∏–≥–∞–µ—Ç—Å—è –ø–æ–¥ —ç—Ç–∏–º –æ–∫–Ω–æ–º;
  - –º–∞—Å—à—Ç–∞–± –º–µ–Ω—è–µ—Ç—Å—è –∫–æ–ª–µ—Å–æ–º –º—ã—à–∏ –∏–ª–∏ –∫–Ω–æ–ø–∫–∞–º–∏ ¬´‚àí¬ª/¬´+¬ª –≤–Ω–∏–∑—É —Å–ø—Ä–∞–≤–∞;
  - —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ –≤—ã—Ö–æ–¥–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ç–µ–º, —á—Ç–æ –≤–∏–¥–Ω–æ –≤ –æ–∫–Ω–µ.
- **OknoScale** ‚Äî —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º —Ç–æ–π –∂–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —Å –∏–∑–º–µ–Ω—è–µ–º–æ–π —à–∏—Ä–∏–Ω–æ–π –æ–∫–Ω–∞ (–¥–ª—è –ø—Ä–æ–± —Ä–∞–∑–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–æ–≤–æ–∫).

–ü—Ä–∞–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ Split / Split3 / OknoFix / OknoScale / Edits, –∫–∞–∂–¥—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å, —Å–∫–∞—á–∞—Ç—å –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å.

## üé® Color Management

**Image output is always JPEG + sRGB with embedded ICC profile.**

–í—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –≤—ã—Ö–æ–¥–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –∏–º–µ—é—Ç —Ñ–æ—Ä–º–∞—Ç JPEG —Å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º ICC –ø—Ä–æ—Ñ–∏–ª–µ–º sRGB. –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –æ —Ü–≤–µ—Ç–æ–≤–æ–º –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–µ, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è—Ö –∏ best practices —Å–º. –≤ [docs/COLOR_MANAGEMENT.md](docs/COLOR_MANAGEMENT.md).

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ
- `dotnet run --project src/Jmaka.Api --launch-profile http`
- –æ—Ç–∫—Ä—ã—Ç—å `http://localhost:5189/`

## API (–∫—Ä–∞—Ç–∫–æ)
- `POST /upload` (multipart/form-data –ø–æ–ª–µ `files`, –º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ)
- `POST /upload-video` (multipart/form-data –ø–æ–ª–µ `file`, –æ–¥–∏–Ω —Ñ–∞–π–ª)
- `POST /video-process` (JSON `{ storedName, trimStartSec, trimEndSec, cutStartSec, cutEndSec, outputWidth, targetSizeMb, verticalOffsetPx, segments, cropX, cropY, cropW, cropH, rotateDeg, flipH, flipV, speed, muteAudio }`)
- `POST /resize` (JSON `{ storedName, width }`)
- `POST /crop` (JSON `{ storedName, x, y, width, height }`)
- `POST /split` (JSON `{ storedNameA, storedNameB, a, b }`, —Ä–µ–∑—É–ª—å—Ç–∞—Ç 1280√ó720)
- `POST /split3` (JSON `{ storedNameA, storedNameB, storedNameC, a, b, c }`, —Ä–µ–∑—É–ª—å—Ç–∞—Ç 1280√ó720)
- `POST /oknofix` (JSON `{ storedName, x, y, w, h }`, –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –ø–æ PNG-—à–∞–±–ª–æ–Ω—É)
- `POST /oknoscale` (JSON `{ storedName, x, y, w, h }`, –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ —Å –∏–∑–º–µ–Ω—è–µ–º–æ–π —à–∏—Ä–∏–Ω–æ–π –æ–∫–Ω–∞)
- `POST /image-edit-preview` (JSON `{ storedName, brightness, contrast, saturation, hue, exposure, vibrance }`)
- `POST /image-edit-apply` (JSON `{ storedName, brightness, contrast, saturation, hue, exposure, vibrance }`)
- `GET /history`
- `GET /composites`
- `POST /delete` (JSON `{ storedName }`)
- `POST /delete-composite` (JSON `{ relativePath }`)

## –î–µ–ø–ª–æ–π –Ω–∞ Ubuntu 24 (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ)
–ù—É–∂–Ω–æ: VPS —Å Ubuntu 24 + —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π nginx (–∫–∞–∫ reverse-proxy). –£—Å—Ç–∞–Ω–æ–≤—â–∏–∫ —Å–∞–º –ø–æ—Å—Ç–∞–≤–∏—Ç ffmpeg/ffprobe –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤–∏–¥–µ–æ.

### –í–∞—Ä–∏–∞–Ω—Ç A (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) ‚Äî —Å–∫–∞—á–∞—Ç—å –≥–æ—Ç–æ–≤—ã–π –∞—Ä—Ö–∏–≤ –∏–∑ GitHub Releases
–ú—ã –ø—Ä–∏–∫–ª–∞–¥—ã–≤–∞–µ–º –≥–æ—Ç–æ–≤—ã–µ –∞—Ä—Ö–∏–≤—ã –∫ —Ä–µ–ª–∏–∑–∞–º –∏ –±—É–¥–µ–º –¥–µ–ª–∞—Ç—å —Ç–∞–∫ –≤—Å–µ–≥–¥–∞.

#### –û–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞: —Å–∫–∞—á–∞—Ç—å –∞—Ä—Ö–∏–≤ + (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) —Ä–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å –≤ –¥–æ–º–∞—à–Ω—é—é –ø–∞–ø–∫—É + –∑–∞–ø—É—Å—Ç–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫
```bash path=null start=null
curl -L -o ~/jmaka.tar.gz \
  https://github.com/Efidripy/Jmaka/releases/latest/download/jmaka-linux-x64.tar.gz \
&& mkdir -p ~/jmaka_bundle \
&& tar -xzf ~/jmaka.tar.gz -C ~/jmaka_bundle \
&& curl -L -o ~/jmaka-install.sh \
  https://raw.githubusercontent.com/Efidripy/Jmaka/main/deploy/ubuntu24/install.sh \
&& bash ~/jmaka-install.sh --interactive
```

–ü–æ—è—Å–Ω–µ–Ω–∏—è:
- `~/jmaka.tar.gz` ‚Äî –∞—Ä—Ö–∏–≤ —Ä–µ–ª–∏–∑–∞.
- `~/jmaka_bundle/` ‚Äî —Ä–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∞—Ä—Ö–∏–≤–∞ (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏). –£—Å—Ç–∞–Ω–æ–≤—â–∏–∫ –≤—Å—ë —Ä–∞–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç tar.gz –∏ —Å–∞–º —Ä–∞—Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç —Ñ–∞–π–ª—ã –≤ `/var/www/jmaka/...`.

### –í–∞—Ä–∏–∞–Ω—Ç B ‚Äî —Å–æ–±—Ä–∞—Ç—å –∞—Ä—Ö–∏–≤ —Å–∞–º–æ–º—É (–Ω–∞ Windows)
–ò–∑ –∫–æ—Ä–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:
- `powershell -NoProfile -ExecutionPolicy Bypass -File .\deploy\publish-linux.ps1`

–†–µ–∑—É–ª—å—Ç–∞—Ç: `artifacts/jmaka-linux-x64.tar.gz`

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Å—Ç–∞–Ω—Å–∞ (–º–∞—Å—Ç–µ—Ä)
–ï—Å–ª–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —É–∂–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–∞–ø—Ä—è–º—É—é:
- `bash deploy/ubuntu24/install.sh`

–ò–ª–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è ‚Äú–±–µ–∑ git‚Äù):
- —Å–∫–∞—á–∞—Ç—å `install.sh` –≤ –¥–æ–º–∞—à–Ω—é—é –ø–∞–ø–∫—É –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å: `bash ~/jmaka-install.sh`

–°–∫—Ä–∏–ø—Ç —Å–∞–º –∑–∞–ø—Ä–æ—Å–∏—Ç sudo (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ) –∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–æ–∑—å–º—ë—Ç –∞—Ä—Ö–∏–≤ –∏–∑ `~/jmaka.tar.gz`.

–°–∫—Ä–∏–ø—Ç –∑–∞–¥–∞—Å—Ç –≤–æ–ø—Ä–æ—Å—ã –∏:
- —Ä–∞–∑–ª–æ–∂–∏—Ç —Ñ–∞–π–ª—ã –≤ `/var/www/jmaka/<name>/app`
- —Å–æ–∑–¥–∞—Å—Ç storage –≤ `/var/www/jmaka/<name>/storage`
- —Å–æ–∑–¥–∞—Å—Ç systemd —Å–µ—Ä–≤–∏—Å `jmaka-<name>` –Ω–∞ `127.0.0.1:<port>`
- –ø—Ä–æ–≤–µ—Ä–∏—Ç –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (–ø–∞–∫–µ—Ç—ã, runtime)
- –ø–æ–∫–∞–∂–µ—Ç –∑–∞–Ω—è—Ç—ã–µ –ø–æ—Ä—Ç—ã –∏ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç –ø–µ—Ä–≤—ã–π —Å–≤–æ–±–æ–¥–Ω—ã–π –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 5000-5999
- –ø–æ –≤—ã–±–æ—Ä—É: —Ä–∞—Å–ø–µ—á–∞—Ç–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥ nginx –∏–ª–∏ —Å–æ–∑–¥–∞—Å—Ç —Ñ–∞–π–ª –≤ `/etc/nginx/...`

### –î–≤–∞ —Å—Ü–µ–Ω–∞—Ä–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –¥–æ–º–µ–Ω—É
1) –û—Ç–¥–µ–ª—å–Ω—ã–π –¥–æ–º–µ–Ω/–ø–æ–¥–¥–æ–º–µ–Ω —Ü–µ–ª–∏–∫–æ–º –ø–æ–¥ Jmaka (root `/`)
- –≤—ã–±–∏—Ä–∞–π—Ç–µ path prefix `/`
- nginx –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç `location /` –Ω–∞ `127.0.0.1:<port>`

2) –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –¥–æ–º–µ–Ω—É –≤ –ø–æ–¥–ø–∞–ø–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä `/jmaka/`)
- –≤—ã–±–∏—Ä–∞–π—Ç–µ path prefix `/jmaka/`
- –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞–µ—Ç base-path —á–µ—Ä–µ–∑ `JMAKA_BASE_PATH=/jmaka`
- nginx –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å `location /jmaka/ { proxy_pass http://127.0.0.1:<port>; }`
  (–≤–∞–∂–Ω–æ: –ë–ï–ó —Å–ª—ç—à–∞ –≤ –∫–æ–Ω—Ü–µ proxy_pass, —á—Ç–æ–±—ã –ø—Ä–µ—Ñ–∏–∫—Å /jmaka/ –¥–æ—à—ë–ª –¥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
–°—Ç–∞—Ç—É—Å –∏ –ª–æ–≥–∏:
- `systemctl status jmaka-<name> --no-pager`
- `journalctl -u jmaka-<name> -n 200 --no-pager`

–ü—Ä–æ–≤–µ—Ä–∫–∞ nginx:
- `nginx -t && systemctl reload nginx`

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `JMAKA_STORAGE_ROOT` ‚Äî –∫—É–¥–∞ –ø–∏—Å–∞—Ç—å upload/resized/preview/data (—Å–∫—Ä–∏–ø—Ç —Å—Ç–∞–≤–∏—Ç –≤ `/var/www/jmaka/<name>/storage`)
- `JMAKA_BASE_PATH` ‚Äî base-path –¥–ª—è –ø–æ–¥–ø–∞–ø–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä `/jmaka`), `/` = –∫–æ—Ä–µ–Ω—å

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∏–Ω—Å—Ç–∞–Ω—Å–∞ (update-instance.sh)
–ï—Å–ª–∏ Jmaka —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —á–µ—Ä–µ–∑ `install.sh` –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ systemd-—Å–µ—Ä–≤–∏—Å `jmaka-<name>`, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–µ–ª–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å–∫—Ä–∏–ø—Ç–æ–º:

1. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π –∞—Ä—Ö–∏–≤ —Å —Ä–µ–ª–∏–∑–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä, –Ω–∞–ø—Ä–∏–º–µ—Ä:
   ```bash
   cd ~
   curl -L -o jmaka.tar.gz \
     https://github.com/Efidripy/Jmaka/releases/latest/download/jmaka-linux-x64.tar.gz
   ```

2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–ø–¥–µ–π—Ç–µ—Ä –∏–∑ –∫–æ—Ä–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è **–∏–ª–∏** –ø–æ—Å–ª–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è `update-instance.sh`:
   ```bash
   # –µ—Å–ª–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —É–∂–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
   sudo bash deploy/ubuntu24/update-instance.sh

   # –ª–∏–±–æ —Å–∫–∞—á–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –æ—Ç–¥–µ–ª—å–Ω–æ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å
   curl -L -o ~/jmaka-update.sh \
     https://raw.githubusercontent.com/Efidripy/Jmaka/main/deploy/ubuntu24/update-instance.sh
   sudo bash ~/jmaka-update.sh
   ```

–°–∫—Ä–∏–ø—Ç —Å–∞–º:
- –Ω–∞–π–¥—ë—Ç –≤—Å–µ `jmaka-*.service` –∏ –ø–æ–∫–∞–∂–µ—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ appDir, –ø–æ—Ä—Ç, base-path –∏ —Ç–µ–∫—É—â—É—é –≤–µ—Ä—Å–∏—é;
- –¥–∞—Å—Ç –≤—ã–±—Ä–∞—Ç—å –æ–¥–∏–Ω –∏–Ω—Å—Ç–∞–Ω—Å –∏–ª–∏ –≤—Å–µ —Å—Ä–∞–∑—É;
- —Å–ø—Ä–æ—Å–∏—Ç –ø—É—Ç—å –∫ –∞—Ä—Ö–∏–≤—É (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `~/jmaka.tar.gz`);
- –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å(—ã), —Å–¥–µ–ª–∞–µ—Ç –±—ç–∫–∞–ø –∫–∞—Ç–∞–ª–æ–≥–∞ `app` ‚Üí `app.bak-YYYYMMDD-HHMMSS`;
- –æ—á–∏—Å—Ç–∏—Ç `app`, —Ä–∞—Å–ø–∞–∫—É–µ—Ç —Ç—É–¥–∞ –Ω–æ–≤—ã–π –∞—Ä—Ö–∏–≤, –≤—ã—Å—Ç–∞–≤–∏—Ç –ø—Ä–∞–≤–∞ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç —Å–µ—Ä–≤–∏—Å(—ã).

## ü™ü Windows (–ª–æ–∫–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã)
### –ó–∞–ø—É—Å–∫
- `dotnet run --project src/Jmaka.Api --launch-profile http`
- –æ—Ç–∫—Ä—ã—Ç—å `http://localhost:5189/`

### –ò–∑–≤–µ—Å—Ç–Ω–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å (file lock)
–ï—Å–ª–∏ `dotnet build -c Release` –ø–∞–¥–∞–µ—Ç —Å –æ—à–∏–±–∫–æ–π, —á—Ç–æ —Ñ–∞–π–ª `Jmaka.Api.exe` –∑–∞–Ω—è—Ç ‚Äî –∑–Ω–∞—á–∏—Ç –∑–∞–ø—É—â–µ–Ω –ø—Ä–æ—Ü–µ—Å—Å –∏–∑ `bin/Release`. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ–≥–æ –∏ –ø–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ.

## Contributors

- [@Efidripy](https://github.com/Efidripy) ‚Äî Efidripy Efi
